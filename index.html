<!DOCTYPE html>
<html>
<head>
    <script src="https://unpkg.com/@ffmpeg/ffmpeg@0.12.7/dist/umd/ffmpeg.js"></script>
    <script src="https://unpkg.com/@ffmpeg/util@0.12.1/dist/umd/index.js"></script>
</head>
<body>
    <input type="file" id="fileInput" accept="video/*">
    <video id="output" controls style="display: none;"></video>
    
    <script>
        const { FFmpeg } = FFmpegWASM;
        const { fetchFile } = FFmpegUtil;
        
        const ffmpeg = new FFmpeg();
        
        async function loadFFmpeg() {
            await ffmpeg.load({
                coreURL: 'https://unpkg.com/@ffmpeg/core@0.12.4/dist/umd/ffmpeg-core.js',
                wasmURL: 'https://unpkg.com/@ffmpeg/core@0.12.4/dist/umd/ffmpeg-core.wasm',
            });
        }
        
        document.getElementById('fileInput').addEventListener('change', async (e) => {
            const file = e.target.files[0];
            if (!file) return;
            
            await loadFFmpeg();
            
            await ffmpeg.writeFile('input.mp4', await fetchFile(file));
            await ffmpeg.exec(['-i', 'input.mp4', 'output.webm']);
            
            const data = await ffmpeg.readFile('output.webm');
            const video = document.getElementById('output');
            video.src = URL.createObjectURL(
                new Blob([data.buffer], { type: 'video/webm' })
            );
            video.style.display = 'block';
        });
    </script>
</body>
</html>